// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider   = "prisma-client-js"
  output     = "../.prisma/client"
  engineType = "binary"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_URL")
}

// example table used in the express router example

// schema.prisma
// making Edges table
// 2 columns:
// StartNodeID which is a VARCHAR (mixed datatype)
// endNodeID which is a VARCHAR as well
model Edges {
  EdgeID      String @id // EdgeID column in Edges table
  StartNodeID String // StartNodeID column in Edges table
  EndNodeID   String // EndNodeID column in Edges table
}

// making Nodes table
// 8 Columns:
// nodeID which is a string
// xcoord which is a 4digit CHAR
// ycoord which is a 3-4 digit CHAR
// floor 2 digit CHAR
// building is a string
// nodetype is a string
// longname is a string
// shortName is a string

model Nodes {
  NodeID    String           @id
  Xcoord    String
  Ycoord    String
  Floor     String
  Building  String
  NodeType  String
  LongName  String
  ShortName String
  Requests  GeneralRequest[]
}

//--------------- Iteration 4 -----------------------------

// userID which is a String and the primary key
// email which is the employee's email
// emailVerified is a boolean of whether the employee verified their email
// nickname is the name of the employee
// lastLogin is the time the employee last logged in
// serviceRequestsCompleted is an Int

model Employee {
  userID                   String           @id
  email                    String
  emailVerified            Boolean
  nickname                 String           @unique
  lastLogin                DateTime
  serviceRequestsCompleted Int
  Requests                 GeneralRequest[]
}

//--------------- Iteration 3-----------------------------
// Adding staff table for use with auth0
// 4 columns
// Email which is a string, ideally in the format XXXXX@XXXXX.XXXXX
// UserID which is a string of the staff memeber's auth0 userID

model staff {
  userid String @id
  email  String
}

//--------------- Iteration 2 -----------------------------

// making General Request table
// 10 Columns:
// RequestID which is an Int
// RequesterName which is a string of the person making the request
// RequestType which is a string
// Priority which is a string (low, medium, high, emergency)
// Location which is a Node Object
// LocationNodeID is a string which specifies the Node ID of the location of the Node
// Employee which is an Employee Object
// EmployeeName which is the specific name of the employee
// Details1 which is a string of whatever important details dependent on type of request
// Details2 which is a string of whatever important details dependent on type of request
// Details3 which is a string of whatever important details dependent on type of request
// DeliveryDate which is a DateTime of whatever the delievery date is supposed to be
// Status which is a string of either (Unassigned, Assigned, InProgress, or Closed)

model GeneralRequest {
  RequestID      Int      @id @default(autoincrement())
  RequesterName  String
  RequestType    String
  Priority       String
  Location       Nodes    @relation(fields: [LocationNodeID], references: [NodeID], onDelete: Cascade)
  LocationNodeID String
  Employee       Employee @relation(fields: [EmployeeName], references: [nickname], onDelete: Cascade)
  EmployeeName   String
  Details1       String
  Details2       String
  Details3       String
  DeliveryDate   DateTime
  Status         String
}

//-----------------------------OLD-----------------------------

// model Request {
//   RequestID     Int      @id @default(autoincrement())
//   Time          DateTime
//   Type          String
//   Details       String
//   UserID        Int // USE RELATION FOR LATER ITERATION (When we need to make a Users table)
//   Destination   Nodes    @relation(fields: [DestinationID], references: [LongName])
//   DestinationID String
// }

// npx prisma generate for schema. can see using database
// npx prisma migrate dev --name init to run the code to add to a database. will overwrite anything in public.

// model Request {
//   RequestID     Int      @id @default(autoincrement())
//   Time          DateTime
//   Type          String
//   Details       String
//   UserID        Int // USE RELATION FOR LATER ITERATION (When we need to make a Users table)
//   Destination   Nodes    @relation(fields: [DestinationID], references: [NodeID])
//   DestinationID String
// }

// model FlowerRequest {
//   RequestID         Int      @id @default(autoincrement())
//   Time              DateTime
//   DeliveryDate      DateTime
//   RecipientName     String
//   FlowerType        String
//   UserID            Int // USE RELATION FOR LATER ITERATION (When we need to make a Users table)
//   Destination       Nodes    @relation(fields: [DestinationNodeID], references: [NodeID])
//   DestinationNodeID String
// }

// npx prisma generate for schema. can see using database
// npx prisma migrate dev --name init to run the code to add to a database. will overwrite anything in public.
